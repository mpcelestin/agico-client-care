<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>Admin View - Accident Declaration #{{ declaration.id }}</title>
    <style>
        @page {
            size: A4;
            margin: 1.5cm;
        }
        
        body { 
            font-family: Arial, sans-serif; 
            line-height: 1.6; 
            margin: 0;
            padding: 0;
            color: #333;
            font-size: 12px;
        }
        
        .header { 
            text-align: center; 
            margin-bottom: 25px; 
            border-bottom: 2px solid #2c3e50;
            padding-bottom: 15px;
        }
        
        .logo { 
            height: 70px; 
            margin-bottom: 10px;
        }
        
        h1 { 
            color: #2c3e50; 
            margin: 5px 0;
            font-size: 1.8em;
        }
        
        h2 {
            color: #2c3e50;
            border-bottom: 1px solid #eee;
            padding-bottom: 5px;
            font-size: 1.4em;
            margin-top: 30px;
            page-break-after: avoid;
        }
        
        h3 {
            font-size: 1.2em;
            color: #2c3e50;
            margin-bottom: 10px;
            page-break-after: avoid;
        }
        
        .section { 
            margin-bottom: 30px;
            page-break-inside: avoid;
        }
        
        .footer { 
            margin-top: 40px; 
            font-size: 0.8em; 
            text-align: center;
            color: #777;
            border-top: 1px solid #eee;
            padding-top: 10px;
        }
        
        table { 
            width: 100%; 
            border-collapse: collapse; 
            margin-bottom: 20px;
            page-break-inside: avoid;
        }
        
        th, td { 
            border: 1px solid #ddd; 
            padding: 8px; 
            text-align: left; 
            vertical-align: top;
        }
        
        th { 
            background-color: #f2f2f2; 
            font-weight: bold;
            width: 30%;
        }
        
        .document-image { 
            max-width: 100%; 
            max-height: 250px;
            height: auto; 
            margin-top: 10px; 
            border: 1px solid #ddd;
            display: block;
            page-break-inside: avoid;
        }
        
        .document-container { 
            margin-bottom: 25px;
            page-break-inside: avoid;
        }
        
        .document-title {
            font-weight: bold;
            margin-bottom: 5px;
        }
        
        .status {
            padding: 3px 8px;
            border-radius: 3px;
            font-weight: bold;
            display: inline-block;
        }
        
        .status-pending {
            background-color: #FFF3CD;
            color: #856404;
        }
        
        .status-approved {
            background-color: #D4EDDA;
            color: #155724;
        }
        
        .status-rejected {
            background-color: #F8D7DA;
            color: #721C24;
        }
        
        .admin-note {
            background-color: #f8f9fa;
            padding: 10px;
            border-left: 4px solid #6c757d;
            margin: 10px 0;
        }
        
        .description-box {
            background-color: #f8f9fa;
            padding: 12px;
            border: 1px solid #ddd;
            margin: 10px 0;
            border-radius: 4px;
        }
        
        .no-data {
            color: #777;
            font-style: italic;
        }
    </style>
</head>
<body>
    <div class="header">
        <h1>ACCIDENT DECLARATION REPORT</h1>
        <p>Declaration #{{ declaration.id }} | Generated on {{ now.strftime('%Y-%m-%d %H:%M') }}</p>
    </div>
    
    <div class="section admin-info">
        <h2>Report Information</h2>
        <table>
            <tr>
                <th>Generated By</th>
                <td>{{ current_user.first_name }} {{ current_user.last_name }} (Admin ID: {{ current_user.id }})</td>
            </tr>
            <tr>
                <th>Report Date</th>
                <td>{{ now.strftime('%Y-%m-%d %H:%M') }}</td>
            </tr>
            <tr>
                <th>Declaration Status</th>
                <td>
                    <span class="status status-{{ declaration.status }}">
                        {{ declaration.status|upper }}
                    </span>
                </td>
            </tr>
            {% if declaration.processed_at %}
            <tr>
                <th>Processed Date</th>
                <td>{{ declaration.processed_at.strftime('%Y-%m-%d %H:%M') }}</td>
            </tr>
            {% endif %}
        </table>
    </div>
    
    <div class="section user-info">
        <h2>Client Information</h2>
        <table>
            <tr>
                <th>Client Name</th>
                <td>{{ declaration.user.first_name }} {{ declaration.user.last_name }}</td>
            </tr>
            <tr>
                <th>Client ID</th>
                <td>{{ declaration.user.id }}</td>
            </tr>
            <tr>
                <th>Email Address</th>
                <td>{{ declaration.user.email }}</td>
            </tr>
            <tr>
                <th>Contact Number</th>
                <td>{{ declaration.phone }}</td>
            </tr>
        </table>
    </div>
    
    <div class="section vehicle-info">
        <h2>Vehicle Details</h2>
        <table>
            <tr>
                <th>Make</th>
                <td>{{ declaration.vehicle_make }}</td>
            </tr>
            <tr>
                <th>Model</th>
                <td>{{ declaration.vehicle_model }}</td>
            </tr>
            <tr>
                <th>License Plate</th>
                <td>{{ declaration.license_plate }}</td>
            </tr>
            <tr>
                <th>Insurance Policy Number</th>
                <td>{{ declaration.insurance_policy_number }}</td>
            </tr>
        </table>
    </div>
    
    <div class="section accident-details">
        <h2>Accident Details</h2>
        <table>
            <tr>
                <th>Accident Date & Time</th>
                <td>
                    {% if declaration.accident_datetime %}
                        {{ declaration.accident_datetime.strftime('%Y-%m-%d %H:%M') }}
                    {% else %}
                        N/A
                    {% endif %}
                </td>
            </tr>
            <tr>
                <th>Accident Location</th>
                <td>{{ declaration.accident_location }}</td>
            </tr>
            <tr>
                <th>Declaration Submitted</th>
                <td>{{ declaration.created_at.strftime('%Y-%m-%d %H:%M') }}</td>
            </tr>
        </table>
        
        <h3>Accident Description</h3>
        <div class="description-box">
            {{ declaration.accident_description or '<span class="no-data">No description provided</span>'|safe }}
        </div>
        
        {% if declaration.admin_notes %}
        <h3>Administrator Notes</h3>
        <div class="admin-note">
            {{ declaration.admin_notes }}
        </div>
        {% endif %}
    </div>
    
    <div class="section documents">
        <h2>Supporting Documents</h2>
        
        <div class="document-container">
            <div class="document-title">Accident Photograph 1</div>
            {% if images.accident_image1 %}
                <img class="document-image" src="data:image/jpeg;base64,{{ images.accident_image1 }}" alt="Accident Photograph 1">
            {% else %}
                <p class="no-data">No photograph provided</p>
            {% endif %}
        </div>
        
        <div class="document-container">
            <div class="document-title">Accident Photograph 2</div>
            {% if images.accident_image2 %}
                <img class="document-image" src="data:image/jpeg;base64,{{ images.accident_image2 }}" alt="Accident Photograph 2">
            {% else %}
                <p class="no-data">No photograph provided</p>
            {% endif %}
        </div>
        
        <div class="document-container">
            <div class="document-title">Accident Photograph 3</div>
            {% if images.accident_image3 %}
                <img class="document-image" src="data:image/jpeg;base64,{{ images.accident_image3 }}" alt="Accident Photograph 3">
            {% else %}
                <p class="no-data">No photograph provided</p>
            {% endif %}
        </div>
        
        <div class="document-container">
            <div class="document-title">Vehicle Registration (Carte Rose)</div>
            {% if images.carte_rose_image %}
                <img class="document-image" src="data:image/jpeg;base64,{{ images.carte_rose_image }}" alt="Vehicle Registration">
            {% else %}
                <p class="no-data">No document provided</p>
            {% endif %}
        </div>
        
        <div class="document-container">
            <div class="document-title">Insurance Card</div>
            {% if images.insurance_card_image %}
                <img class="document-image" src="data:image/jpeg;base64,{{ images.insurance_card_image }}" alt="Insurance Card">
            {% else %}
                <p class="no-data">No document provided</p>
            {% endif %}
        </div>
        
        <div class="document-container">
            <div class="document-title">Driver's License</div>
            {% if images.driving_license_image %}
                <img class="document-image" src="data:image/jpeg;base64,{{ images.driving_license_image }}" alt="Driver's License">
            {% else %}
                <p class="no-data">No document provided</p>
            {% endif %}
        </div>
    </div>
    
    <div class="footer">
        <p>BIC Client Care System - Confidential Document</p>
        <p>Generated on {{ now.strftime('%Y-%m-%d at %H:%M') }} | Page <span class="page-number"></span></p>
    </div>
</body>
</html>
